/*! peDesigner 21-11-2014 */
function getGlobalContainer(){var a;return"undefined"!=typeof module?a=module:"undefined"!=typeof window&&(window.exports=window.exports||{},a=window),a}!function(a){var b={};b.test={},a.exports=function(a,c,d){"use strict";function e(a,b){var c,d,e;b&&(L.log(L.LEVEL.DEVELOPMENT,"populateAuthorSearchList: authors : "+JSON.stringify(b)),c=document.getElementById("potentialAuthors"),J(c),d=document.createElement("li"),d.innerHTML="<a href=''>"+b.name+"</a>",e=document.createElement("a"),e.href="",e.onclick=a.bind(this,b,d,c),e.innerHTML="Add Author",d.appendChild(e),c.appendChild(d),$("#potentialAuthors").hasClass("ui-listview")&&$("#potentialAuthors").listview("refresh"))}function f(a){K=a,L.log(L.LEVEL.DEBUG,"In setAuthorData: "+JSON.stringify(K)),$.mobile.changePage("#mainMenu");var b=document.getElementById("userGreeting");b.innerHTML="<center><i>Welcome, "+K.name+"</i>.  Click a button below to manage your stories, chapters, or events.</center>"}function g(){var a,c,d;for(c=document.getElementById("existingStoryList"),J(c),a=0;a<N.storyMap.length;a++)d=document.createElement("li"),d.innerHTML="<a href='#storyData'>"+N.storyMap[a].title+"</a>",d.onclick=I(N.storyMap[a]._id,b.updateStory),c.appendChild(d);$("#existingStoryList").hasClass("ui-listview")&&$("#existingStoryList").listview("refresh")}function h(a){var b,c,d,e,f=!1;for(c=document.getElementById("chapterCheckboxes"),c.innerHTML="",b=0;b<N.chapterMap.length;b++)a&&a.indexOf(N.chapterMap[b]._id)>-1&&(f=!0),e=document.createElement("input"),e.type="checkbox",e.name=N.chapterMap[b]._id,e.id=e.name,e.onclick=H.bind(window,e,"chapters"),f&&(e.checked=!0),d=document.createElement("label"),d.htmlFor=e.name,d.appendChild(document.createTextNode("ID: "+e.name+", Title: "+N.chapterMap[b].title)),c.appendChild(d),c.appendChild(e),f=!1;$("#chapterCheckboxes").trigger("create")}function i(a){var b;a&&""!==a.chapterList&&(b=a.chapterList.toString().split(",")),h(b)}function j(){var a,c,d;for(c=document.getElementById("existingChapterList"),J(c),a=0;a<N.chapterMap.length;a++)d=document.createElement("li"),d.innerHTML="<a href='#chapterData'>"+N.chapterMap[a].title+"</a>",d.onclick=I(N.chapterMap[a]._id,b.updateChapter),c.appendChild(d);$("#existingChapterList").hasClass("ui-listview")&&$("#existingChapterList").listview("refresh")}function k(a){var b,c,d,e,f=!1;for(c=document.getElementById("eventCheckboxes"),c.innerHTML="",b=0;b<N.eventMap.length;b++)a&&a.indexOf(N.eventMap[b]._id)>-1&&(f=!0),e=document.createElement("input"),e.type="checkbox",e.name=N.eventMap[b]._id,e.id=e.name,e.onclick=H.bind(window,e,"cevents"),f&&(e.checked=!0),d=document.createElement("label"),d.htmlFor=e.name,d.appendChild(document.createTextNode("ID: "+e.name+", Title: "+N.eventMap[b].title)),c.appendChild(d),c.appendChild(e),f=!1;$("#eventCheckboxes").trigger("create")}function l(a){var b;a&&void 0!==a.eventList&&(b=a.eventList.toString().split(",")),k(b)}function m(){var a,c,d;for(c=document.getElementById("existingEventList"),J(c),a=0;a<N.eventMap.length;a++)d=document.createElement("li"),d.innerHTML="<a href='#eventData'>"+N.eventMap[a].title+"</a>",d.onclick=I(N.eventMap[a]._id,b.updateEvent),c.appendChild(d);$("#existingEventList").hasClass("ui-listview")&&$("#existingEventList").listview("refresh")}function n(a,b){var c,d=a.value.split(" ");J(document.getElementById("potentialAuthors")),document.getElementById("authorSearch").value="",c=document.getElementById("currentAuthors"),J(c),d.forEach(function(a){var d=document.createElement("li");d.innerHTML="<a href=''>"+a+"</a>";var e=document.createElement("a");e.href="",e.onclick=b.bind(this,d,c),e.innerHTML="Delete Author",d.appendChild(e),c.appendChild(d)}),$("#currentAuthors").hasClass("ui-listview")&&$("#currentAuthors").listview("refresh")}function o(){return""!==createStory.authors.value&&""!==createStory.title.value}function p(){L.log(L.LEVEL.DEBUG,"clearStoryData called."),createStory.title.value="",createStory.authors.value="",createStory.publish.checked=!1,createStory.test.checked=!1,createStory.keywords.value="",$(".rteOverview").jqteVal(""),createStory.image.value="",createStory.chapters.value="",O=0,$("#publish").checkboxradio(),$("#test").checkboxradio(),$("#publish").checkboxradio("refresh"),$("#test").checkboxradio("refresh")}function q(a,b){var c,d;return b.firstChild===b.lastChild?void alert("You cannot remove the last author.\nDelete Story instead. "):(b.removeChild(a),c=document.getElementById("authors"),d=c.value.toString().split(" "),d.splice(d.indexOf(a.textContent.trim()),1),c.value=d,void($("#currentAuthors").hasClass("ui-listview")&&$("#currentAuthors").listview("refresh")))}function r(a,b,c){var d;L.log(L.LEVEL.DEVELOPMENT,"addAuthorStory: "+a._id),c.removeChild(b),d=document.getElementById("authors"),-1===d.value.indexOf(a._id)?(d.value=d.value.concat(" "+a._id),n(createStory.authors,q)):L.log(L.LEVEL.PRODUCTION,"addAuthorToStory:  Found duplicate."),$("#currentAuthors").hasClass("ui-listview")&&$("#currentAuthors").listview("refresh")}function s(){return""!==createChapter.cauthors.value&&""!==createChapter.ctitle.value&&""!==createChapter.clat.value&&""!==createChapter.clng.value&&""!==createChapter.crange.value}function t(a,b){var c,d;return b.firstChild===b.lastChild?void alert("You cannot remove the last author. "):(b.removeChild(a),c=document.getElementById("cauthors"),d=c.value.toString().split(" "),d.splice(d.indexOf(a.textContent.trim()),1),c.value=d,void($("#currentAuthors").hasClass("ui-listview")&&$("#currentAuthors").listview("refresh")))}function u(a,b,c){var d;L.log(L.LEVEL.DEVELOPMENT,"addAuthorToChapter: "+a._id),c.removeChild(b),d=document.getElementById("cauthors"),-1===d.value.indexOf(a._id)&&(d.value=d.value.concat(" "+a._id),n(createChapter.cauthors,t)),$("#currentAuthors").hasClass("ui-listview")&&$("#currentAuthors").listview("refresh")}function v(){createChapter.clat.value=document.getElementById("latspan").innerHTML,createChapter.clng.value=document.getElementById("lngspan").innerHTML}function w(){createChapter.ctitle.value="",createChapter.cteaser.value="",createChapter.cauthors.value="",createChapter.ckeywords.value="",$(".rteCoverview").jqteVal(""),createChapter.cimage.value="",createChapter.clat.value="",createChapter.clng.value="",createChapter.crange.value="",createChapter.cevents.value="",P=0}function x(){return""!==createEvent.eauthors.value&&""!==createEvent.etitle.value&&""!==createEvent.elat.value&&""!==createEvent.elng.value&&""!==createEvent.erange.value}function y(a,b){var c,d;return b.firstChild===b.lastChild?void alert("You cannot remove the last author. "):(b.removeChild(a),c=document.getElementById("eauthors"),d=c.value.toString().split(" "),d.splice(d.indexOf(a.textContent.trim()),1),c.value=d,void($("#currentAuthors").hasClass("ui-listview")&&$("#currentAuthors").listview("refresh")))}function z(a,b,c){var d;L.log(L.LEVEL.DEVELOPMENT,"addAuthorToEvent: "+a._id),c.removeChild(b),d=document.getElementById("eauthors"),-1===d.value.indexOf(a._id)&&(d.value=d.value.concat(" "+a._id),n(createEvent.eauthors,y)),$("#currentAuthors").hasClass("ui-listview")&&$("#currentAuthors").listview("refresh")}function A(a,b,c){var d=document.getElementById("eassetList"),e=document.createElement("li");e.innerHTML="<a href=''>Order: "+a+", Type: "+b+", Data: "+escape(c)+"</a>",e.peOrder=a,e.peType=b,e.peData=c;var f=document.createElement("a");f.href="#editAsset",f.setAttribute("data-rel","popup"),f.setAttribute("data-position-to","window"),f.setAttribute("data-transition","pop"),f.onclick=I(e,B),f.innerHTML="Edit Asset",e.appendChild(f),d.appendChild(e)}function B(a){var b,c;L.log(L.LEVEL.DEBUG,"showEditEventPopup "+a.peOrder+" "+a.peType+" "+a.peData),b=document.getElementById("deleteAssetButton"),b.onclick=C.bind(this,a),c=document.getElementById("editAssetButton"),c.onclick=D.bind(this,a)}function C(a){L.log(L.LEVEL.DEBUG,"removeEventFromList "+a.peOrder+" "+a.peType+" "+a.peData);var b=document.getElementById("eassetList");b.removeChild(a),$("#eassetList").hasClass("ui-listview")&&$("#eassetList").listview("refresh")}function D(a){L.log(L.LEVEL.DEBUG,"updateEventInList "+a.peOrder+" "+a.peType+" "+a.peData),setTimeout(function(){$("#assetEditor").popup("open"),document.getElementById("assetEditorTitle").innerHTML="Asset Update",document.getElementById("assetEditorSubmitButton").onclick=E.bind(this,a),editAssetPopup.assetOrderSelect.value=a.peOrder,editAssetPopup.assetTypeSelect.value=a.peType,$(".rteAssetData").jqteVal(a.peData),$("#assetTypeSelect").selectmenu("refresh")},100)}function E(a){C(a),b.addAssetToEvent()}function F(){createEvent.elat.value=document.getElementById("latspan").innerHTML,createEvent.elng.value=document.getElementById("lngspan").innerHTML}function G(){createEvent.etitle.value="",createEvent.eteaser.value="",createEvent.eauthors.value="",createEvent.ekeywords.value="",createEvent.elat.value="",createEvent.elng.value="",createEvent.erange.value="";var a=document.getElementById("eassetList");J(a),Q=0,$(".rteAssetData").jqteVal("")}function H(a,b){var c,d=document.getElementById(b);a.checked===!0?d.value=d.value+" "+a.id:(c=d.value.split(" "),c.splice(c.indexOf(a.id),1),d.value=c.toString().replace(/,/g," "))}function I(a,b){var c=a;return function(){b(c)}}function J(a){if(a)for(;a.firstChild;)a.removeChild(a.firstChild)}var K,L=d.mhLog,M=a?a:require("./peDesignerServer")(!1,d),N=c?c:require("./peDesignerModel")(d),O=0,P=0,Q=0;return $(document).on("pagebeforeshow","#login",function(){L.log(L.LEVEL.DEBUG,"Pagebeforeshow:  login")}),$(document).on("pagebeforecreate","#login",function(){L.log(L.LEVEL.DEBUG,"Pagebeforecreate:  login")}),$(document).on("pagecreate","#login",function(){L.log(L.LEVEL.DEBUG,"Pagecreate:  login")}),$(document).on("pagebeforeshow","#mainMenu",function(){L.log(L.LEVEL.DEBUG,"Pagebeforeshow:  mainMenu"),M.getAuthorData.bind(this,f)}),$(document).on("pagebeforecreate","#mainMenu",function(){L.log(L.LEVEL.DEBUG,"Pagebeforecreate:  mainMenu")}),$(document).on("pagecreate","#mainMenu",function(){L.log(L.LEVEL.DEBUG,"Pagecreate:  mainMenu")}),$(document).on("pagebeforeshow","#storyManager",function(){L.log(L.LEVEL.DEBUG,"Pagebeforeshow:  storyManager"),b.initStoryManager(),p()}),$(document).on("pagebeforehide","#storyManager",function(){L.log(L.LEVEL.DEBUG,"Pagebeforehide:  storyManager")}),$(document).on("pagebeforecreate","#storyManager",function(){L.log(L.LEVEL.DEBUG,"Pagebeforecreate:  storyManager")}),$(document).on("pagecreate","#storyManager",function(){L.log(L.LEVEL.DEBUG,"Pagecreate:  storyManager"),$(".rteOverview").jqte(),document.getElementById("storyDataButton").onclick=b.createStory}),$(document).on("pagebeforeshow","#chapterManager",function(){L.log(L.LEVEL.DEBUG,"Pagebeforeshow:  chapterManager"),b.initChapterManager(),w()}),$(document).on("pagebeforehide","#chapterManager",function(){L.log(L.LEVEL.DEBUG,"Pagebeforehide:  chapterManager")}),$(document).on("pagebeforecreate","#chapterManager",function(){L.log(L.LEVEL.DEBUG,"Pagebeforecreate:  chapterManager")}),$(document).on("pagecreate","#chapterManager",function(){L.log(L.LEVEL.DEBUG,"Pagecreate:  chapterManager"),$(".rteCoverview").jqte(),document.getElementById("chapterDataButton").onclick=b.createChapter}),$(document).on("pagebeforeshow","#eventManager",function(){L.log(L.LEVEL.DEBUG,"Pagebeforeshow:  eventManager"),b.initEventManager(),G()}),$(document).on("pagebeforehide","#eventManager",function(){L.log(L.LEVEL.DEBUG,"Pagebeforehide:  eventManager")}),$(document).on("pagebeforecreate","#eventManager",function(){L.log(L.LEVEL.DEBUG,"Pagebeforecreate:  eventManager")}),$(document).on("pagecreate","#eventManager",function(){L.log(L.LEVEL.DEBUG,"Pagecreate:  eventManager"),$(".rteAssetData").jqte(),document.getElementById("eventDataButton").onclick=b.createEvent}),$(document).on("pagebeforeshow","#storyData",function(){L.log(L.LEVEL.DEBUG,"Pagebeforeshow:  storyData")}),$(document).on("pagebeforehide","#storyData",function(){L.log(L.LEVEL.DEBUG,"Pagebeforehide:  storyData")}),$(document).on("pagebeforecreate","#storyData",function(){L.log(L.LEVEL.DEBUG,"Pagebeforecreate:  storyData")}),$(document).on("pagecreate","#storyData",function(){L.log(L.LEVEL.DEBUG,"Pagecreate:  storyData"),document.getElementById("storyAuthorManagement").onclick=b.initAuthorManagement.bind(this,createStory,q),document.getElementById("submitStoryButton").onclick=b.submitStoryData,document.getElementById("deleteStoryBtn").onclick=b.deleteStoryData}),$(document).on("pagebeforeshow","#chapterData",function(){L.log(L.LEVEL.DEBUG,"Pagebeforeshow:  chapterData")}),$(document).on("pagebeforehide","#chapterData",function(){L.log(L.LEVEL.DEBUG,"Pagebeforehide:  chapterData")}),$(document).on("pagebeforecreate","#chapterData",function(){L.log(L.LEVEL.DEBUG,"Pagebeforecreate:  chapterData")}),$(document).on("pagecreate","#chapterData",function(){L.log(L.LEVEL.DEBUG,"Pagecreate:  chapterData"),document.getElementById("chapterAuthorManagement").onclick=b.initAuthorManagement.bind(this,createChapter,t),document.getElementById("submitChapterButton").onclick=b.submitChapterData,document.getElementById("deleteChapterBtn").onclick=b.deleteChapterData,document.getElementById("openMapViewChapter").onclick=b.initMapViewChapter}),$(document).on("pagebeforeshow","#eventData",function(){L.log(L.LEVEL.DEBUG,"Pagebeforeshow:  eventData")}),$(document).on("pagebeforehide","#eventData",function(){L.log(L.LEVEL.DEBUG,"Pagebeforehide:  eventData")}),$(document).on("pagebeforecreate","#eventData",function(){L.log(L.LEVEL.DEBUG,"Pagebeforecreate:  eventData")}),$(document).on("pagecreate","#eventData",function(){L.log(L.LEVEL.DEBUG,"Pagecreate:  eventData"),document.getElementById("eventAuthorManagement").onclick=b.initAuthorManagement.bind(this,createEvent,y),document.getElementById("submitEventButton").onclick=b.submitEventData,document.getElementById("deleteEventBtn").onclick=b.deleteEventData,document.getElementById("openMapViewEvent").onclick=b.initMapViewEvent,document.getElementById("addAssetButton").onclick=b.addNewAsset,document.getElementById("assetEditorSubmitButton").onclick=b.addAssetToEvent}),$(document).on("pagebeforeshow","#authorView",function(){L.log(L.LEVEL.DEBUG,"Pagebeforeshow:  authorView")}),$(document).on("pagebeforecreate","#authorView",function(){L.log(L.LEVEL.DEBUG,"Pagebeforecreate:  authorView")}),$(document).on("pagecreate","#authorView",function(){L.log(L.LEVEL.DEBUG,"Pagecreate:  authorView")}),$(document).on("pageshow","#mapView",function(){L.log(L.LEVEL.DEBUG,"PageShow:  mapViewChapters"),google.maps.event.trigger(document.getElementById("map_canvas"),"resize")}),b.autoLogin=function(){M.checkAuth(function(a){L.log(L.LEVEL.DEBUG,"authorInfo = "+JSON.stringify(a)),L.log(L.LEVEL.DEBUG,"authorInfo.loggedIn = "+a.loggedIn),a.loggedIn&&b.showMainMenu()})},b.showMainMenu=function(){"undefined"==typeof K?(L.log(L.LEVEL.DEBUG,"showMainMenu:  author is undefined"),M.getAuthorData(f)):(L.log(L.LEVEL.DEBUG,"showMainMenu:  author is defined"),f(K))},b.initStoryManager=function(){g()},b.updateStory=function(a){var b=document.getElementById("storyDataTitle");b.innerHTML="Update Story";var c=N.findStoryByID(a);c&&(createStory.title.value=c.title,createStory.authors.value=c.authors?c.authors.toString().replace(/,/g," "):"",createStory.publish.checked=c.publish,createStory.test.checked=c.test,createStory.keywords.value=c.keywords?c.keywords.toString().replace(/,/g," "):"",$(".rteOverview").jqteVal(c.overview),createStory.image.value=c.image,createStory.chapters.value=c.chapterList?c.chapterList.toString().replace(/,/g," "):"",O=c._id);var d=document.getElementById("deleteStoryBtn");d.style.display="block",$("#storyDataFooter").trigger("refresh"),i(c),$("#publish").checkboxradio(),$("#test").checkboxradio(),$("#publish").checkboxradio("refresh"),$("#test").checkboxradio("refresh")},b.createStory=function(){var a;a=document.getElementById("storyDataTitle"),a.innerHTML="Create Story",createStory.authors.value=b.getAuthorData()._id;var c=document.getElementById("deleteStoryBtn");c.style.display="none",$("#storyDataFooter").trigger("refresh"),i(void 0)},b.initChapterManager=function(){j()},b.updateChapter=function(a){var b=document.getElementById("chapterDataTitle");b.innerHTML="Update Chapter";var c=N.findChapterByID(a);c&&(createChapter.ctitle.value=c.title,createChapter.cteaser.value=c.teaser,createChapter.cauthors.value=c.authors?c.authors.toString().replace(/,/g," "):"",createChapter.ckeywords.value=c.keywords.toString().replace(/,/g," "),$(".rteCoverview").jqteVal(c.overview),createChapter.cimage.value=c.image,createChapter.clat.value=c.proximity.lat,createChapter.clng.value=c.proximity.lng,createChapter.crange.value=c.proximity.range,createChapter.cevents.value=c.eventList?c.eventList.toString().replace(/,/g," "):"",P=c._id);var d=document.getElementById("deleteChapterBtn");d.style.display="block",$("#chapterDataFooter").trigger("refresh"),l(c)},b.createChapter=function(){var a;a=document.getElementById("chapterDataTitle"),a.innerHTML="Create Chapter",createChapter.cauthors.value=b.getAuthorData()._id;var c=document.getElementById("deleteChapterBtn");c.style.display="none",$("#chapterDataFooter").trigger("refresh"),l(void 0)},b.initEventManager=function(){m()},b.updateEvent=function(a){var b,c=document.getElementById("eventDataTitle");c.innerHTML="Update Event";var d=N.findEventByID(a);if(d){if(createEvent.etitle.value=d.title,createEvent.eteaser.value=d.teaser,createEvent.eauthors.value=d.authors?d.authors.toString().replace(/,/g," "):"",createEvent.ekeywords.value=d.keywords?d.keywords.toString().replace(/,/g," "):"",d.proximity&&(createEvent.elat.value=d.proximity.lat,createEvent.elng.value=d.proximity.lng,createEvent.erange.value=d.proximity.range),d.assetList)for(b=0;b<d.assetList.length;b++)A(d.assetList[b].order,d.assetList[b].format,d.assetList[b].uri);Q=d._id,$("#eassetList").hasClass("ui-listview")&&$("#eassetList").listview("refresh")}var e=document.getElementById("deleteEventBtn");e.style.display="block",$("#eventDataFooter").trigger("refresh"),$("#erepeats").checkboxradio("refresh")},b.createEvent=function(){var a;a=document.getElementById("eventDataTitle"),a.innerHTML="Create Event",createEvent.eauthors.value=b.getAuthorData()._id;var c=document.getElementById("deleteEventBtn");c.style.display="none",$("#eventDataFooter").trigger("refresh")},b.initAuthorManagement=function(a,c){var d;a===createStory?(n(a.authors,c),d=r):a===createChapter?(n(a.cauthors,c),d=u):a===createEvent&&(n(a.eauthors,c),d=z),document.getElementById("authorSearch").onkeypress=b.authorSearch.bind(this,d)},b.authorSearch=function(a,b){var c,d=/\s+/;13===b.keyCode&&(c=document.getElementById("authorSearch").value,c&&c.trim().split(d).length<3?M.authorSearch(c,e.bind(this,a)):document.getElementById("authorSearch").value="Invalid Search Text...Try again.")},b.submitStoryData=function(){var a;if(o()){var b={};b.title=createStory.title.value,""!==createStory.authors.value&&(b.authors=createStory.authors.value.split(" ")),b.publish=createStory.publish.checked,b.test=createStory.test.checked,""!==createStory.keywords.value&&(b.keywords=createStory.keywords.value.split(" ")),b.overview=createStory.overview.value,b.image=createStory.image.value,""!==createStory.chapters.value&&(b.chapterList=createStory.chapters.value.replace(/(^\s+|\s+$)/g,""),b.chapterList=b.chapterList.split(" ")),L.log(L.LEVEL.DEBUG,"Chapter List is "+b.chapterList),0===O?(a='Adding story to server. \nHit "ok" to return to main menu!',M.submitNewStory(b,K,g)):(a='Updating story on server. \nHit "ok" to return to main menu!',M.submitUpdateStory(O,b,g)),alert(a),$.mobile.changePage("#storyManager",{reverse:!0})}else a="Missing required data.  Please ensure you have valid values for both the title and authors fields.",alert(a)},b.validateStoryPublish=function(){var a;return createStory.publish.checked===!0?""!==createStory.chapters.value&&(a=createStory.chapters.value.replace(/(^\s+|\s+$)/g,"").split(" "),a.length>0&&b.validateChaptersPublish(a))?(alert("Valid Story!"),!0):(this.checked=!1,alert("Invalid Story!"),!1):(alert("Marking not Publishable!"),!0)},b.deleteStoryData=function(){confirm("Do you really want to delete this story?")&&(L.log(L.LEVEL.DEBUG,"Delete Story"),M.submitDeleteStory(O,K,g),$.mobile.changePage("#storyManager",{reverse:!0}))},b.submitChapterData=function(){var a;if(s()){var b={};b.title=createChapter.ctitle.value,b.teaser=createChapter.cteaser.value,""!==createChapter.cauthors.value&&(b.authors=createChapter.cauthors.value.split(" ")),""!==createChapter.ckeywords.value&&(b.keywords=createChapter.ckeywords.value.split(" ")),b.overview=createChapter.coverview.value,b.image=createChapter.cimage.value,b.proximity={},b.proximity.lat=createChapter.clat.value,b.proximity.lng=createChapter.clng.value,b.proximity.range=createChapter.crange.value,createChapter.cevents.value&&(b.eventList=createChapter.cevents.value.replace(/(^\s+|\s+$)/g,""),b.eventList=b.eventList.split(" ")),0===P?(a='Adding chapter to server. \nHit "ok" to return to main menu!',M.submitNewChapter(b,j)):(a='Updating chapter on server. \nHit "ok" to return to main menu!',M.submitUpdateChapter(P,b,j)),alert(a),$.mobile.changePage("#chapterManager",{reverse:!0})}else a="Missing required data.  Please ensure you have valid values for the title, authors, latitude, longitude, and range fields.",alert(a)},b.validateChaptersPublish=function(a){var b,c,d;for(b=0,c=a.length;c>b;b++)if(d=N.findChapterByID(a[b]),d.eventList&&d.eventList.length<1)return!1;return!0},b.deleteChapterData=function(){confirm("Do you really want to delete this chapter?")&&(L.log(L.LEVEL.DEBUG,"Delete Chapter"),M.submitDeleteChapter(P,j),$.mobile.changePage("#chapterManager",{reverse:!0}))},b.addNewAsset=function(){L.log(L.LEVEL.DEBUG,"addNewAsset called!"),document.getElementById("assetEditorTitle").innerHTML="Asset Editor",document.getElementById("assetEditorSubmitButton").onclick=b.addAssetToEvent},b.addAssetToEvent=function(){A(editAssetPopup.assetOrderSelect.value,editAssetPopup.assetTypeSelect.value,editAssetPopup.assetDATA.value),$("#eassetList").hasClass("ui-listview")&&$("#eassetList").listview("refresh")},b.submitEventData=function(){var a,b,c;if(x()){var d={};d.title=createEvent.etitle.value,d.teaser=createEvent.eteaser.value,""!==createEvent.eauthors.value&&(d.authors=createEvent.eauthors.value.split(" ")),""!==createEvent.ekeywords.value&&(d.keywords=createEvent.ekeywords.value.split(" ")),d.proximity={},d.proximity.lat=createEvent.elat.value,d.proximity.lng=createEvent.elng.value,d.proximity.range=createEvent.erange.value;var e=document.getElementById("eassetList"),f=e.getElementsByTagName("li");for(d.assetList=[],b=0,c=f.length;c>b;b++)d.assetList[b]={},d.assetList[b].order=f[b].peOrder,d.assetList[b].format=f[b].peType,d.assetList[b].uri=f[b].peData;L.log(L.LEVEL.DEBUG,"Asset List is "+d.assetList),0===Q?(a='Adding event to server. \nHit "ok" to return to main menu!',M.submitNewEvent(d,m)):(a='Updating event on server. \nHit "ok" to return to main menu!',M.submitUpdateEvent(Q,d,m)),alert(a),$.mobile.changePage("#eventManager",{reverse:!0})}else a="Missing required data.  Please ensure you have valid values for the title, authors, latitude, longitude, and range fields.",alert(a)},b.deleteEventData=function(){confirm("Do you really want to delete this event?")&&(M.submitDeleteEvent(Q,m),$.mobile.changePage("#eventManager",{reverse:!0}))},b.initMapViewChapter=function(){document.getElementById("useLocationButton").onclick=v},b.initMapViewEvent=function(){document.getElementById("useLocationButton").onclick=F},b.getAuthorData=function(){return K},b}}(getGlobalContainer());