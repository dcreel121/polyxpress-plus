/*! pePlayer 21-11-2014 */
function getGlobalContainer(){var a;return"undefined"!=typeof module?a=module:"undefined"!=typeof window&&(window.exports=window.exports||{},a=window),a}!function(a){var b={};b.test={},a.exports=function(a,c){"use strict";function d(a,b){var c;for(c=0;c<a.length;c++)if(a[c]._id===b)return a[c]}function e(a,b){b.map(function(b){a.push(b)})}function f(a,b,c){var d,e=[];return b.map(function(b){g.log(g.LEVEL.DEBUG,"Item is "+b),d=a.splice(a.indexOf(b),1),c&&(e=e.concat(d[0].eventList)),g.log(g.LEVEL.DEBUG,"Removing "+JSON.stringify(d))}),g.log(g.LEVEL.DEBUG,"Remove EventList "+JSON.stringify(e)),c?e:void 0}var g=c.mhLog;return b.storyMap=[],b.chapterMap=[],b.eventMap=[],b.addStory=function(a){b.storyMap.push(a)},b.addChapter=function(c){b.chapterMap.push(c),c.openPanel=a.getChapterOpenPanelFunction()},b.addEvent=function(c){b.eventMap.push(c),c.openPanel=a.getEventOpenPanelFunction()},b.populateStoryMap=function(a){return b.storyMap=[],e(b.storyMap,a)},b.populateChapterMap=function(a){return b.chapterMap=[],e(b.chapterMap,a)},b.populateEventMap=function(a){return b.eventMap=[],e(b.eventMap,a)},b.findStoryByID=function(a){return d(b.storyMap,a)},b.findChapterByID=function(a){return d(b.chapterMap,a)},b.findEventByID=function(a){return d(b.eventMap,a)},b.getAllChapters=function(){var a=[];return b.storyMap.map(function(b){g.log(g.LEVEL.DEBUG,"getAllChapters: item = "+b),a=a.concat(b.chapterList)}),g.log(g.LEVEL.DEBUG,"getAllChapters: chapterList = "+a),a},b.getAllEvents=function(){var a=[];return b.chapterMap.map(function(b){a=a.concat(b.eventList)}),a},b.removeStory=function(a){var c,d;d=b.storyMap.splice(b.storyMap.indexOf(b.findStoryByID(a)),1),d&&(c=f(b.chapterMap,d[0].chapterList,!0),c&&f(b.eventMap,c,!1))},b}}(getGlobalContainer());